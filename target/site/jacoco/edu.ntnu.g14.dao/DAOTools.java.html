<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DAOTools.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">demo</a> &gt; <a href="index.source.html" class="el_package">edu.ntnu.g14.dao</a> &gt; <span class="el_source">DAOTools.java</span></div><h1>DAOTools.java</h1><pre class="source lang-java linenums">package edu.ntnu.g14.dao;

import java.io.IOException;
import java.io.RandomAccessFile;
import java.nio.channels.FileChannel;

/**
 * The class provides methods for manipulating files using random access
 */
<span class="nc" id="L10">public class DAOTools {</span>

    /**
    * Inserts the given byte array into the specified file at the specified offset.
    * Any data after the offset is shifted to the right to accommodate the new data.
    *
    * @param data      the byte array to be inserted
    * @param offset    the offset at which to insert the data
    * @param file      the RandomAccessFile object representing the file to be modified
    * @param tempFile  the RandomAccessFile object representing a temporary file used for the insertion
    * @throws IOException  if an I/O error occurs
    */
    public static void insertIntoFile(byte[] data, long offset, RandomAccessFile file, RandomAccessFile tempFile) throws IOException {
<span class="fc" id="L23">        FileChannel fileChannel = file.getChannel();</span>
<span class="fc" id="L24">        FileChannel tempChannel = tempFile.getChannel();</span>

<span class="fc" id="L26">        long transferCount = fileChannel.size() - offset;</span>

<span class="fc" id="L28">        tempChannel.position(0);</span>
<span class="fc" id="L29">        fileChannel.transferTo(offset, transferCount, tempChannel);</span>
<span class="fc" id="L30">        file.seek(offset);</span>
<span class="fc" id="L31">        file.write(data);</span>
<span class="fc" id="L32">        tempChannel.position(0);</span>
<span class="fc" id="L33">        fileChannel.transferFrom(tempChannel, offset + data.length, transferCount);</span>
<span class="fc" id="L34">    }</span>

    /**
    * Replaces a range of bytes in the specified file with the given byte array.
    *
    * @param data      the byte array to replace the existing data with
    * @param start     the starting offset of the data to be replaced
    * @param count     the number of bytes to be replaced
    * @param file      the RandomAccessFile object representing the file to be modified
    * @param tempFile  the RandomAccessFile object representing a temporary file used for the replacement
    * @throws IOException  if an I/O error occurs
    */
    public static void replace(byte[] data, long start, long count, RandomAccessFile file, RandomAccessFile tempFile) throws IOException {
<span class="fc" id="L47">        FileChannel fileChannel = file.getChannel();</span>
<span class="fc" id="L48">        FileChannel tempChannel = tempFile.getChannel();</span>

<span class="fc" id="L50">        long transferCount = fileChannel.size() - (start + count);</span>

<span class="fc" id="L52">        tempChannel.position(0);</span>
<span class="fc" id="L53">        fileChannel.transferTo(start + count, transferCount, tempChannel);</span>
<span class="fc" id="L54">        file.seek(start);</span>
<span class="fc" id="L55">        file.write(data);</span>
<span class="fc" id="L56">        tempChannel.position(0);</span>
<span class="fc" id="L57">        fileChannel.transferFrom(tempChannel, start + data.length, transferCount);</span>
<span class="fc" id="L58">        fileChannel.truncate(start + data.length + transferCount);</span>
<span class="fc" id="L59">    }</span>

    /**
    * Appends the given byte array to the end of the specified file.
    *
    * @param data          the byte array to be appended
    * @param fileStream    the RandomAccessFile object representing the file to be appended to
    * @throws IOException  if an I/O error occurs
    */
    public static void appendToFile(byte[] data, RandomAccessFile fileStream) throws IOException {
<span class="fc" id="L69">        fileStream.seek(fileStream.length());</span>
<span class="fc" id="L70">        fileStream.write(data);</span>
<span class="fc" id="L71">    }</span>

    /**
    * Deletes a range of bytes from the specified file.
    *
    * @param start     the starting offset of the data to be deleted
    * @param count     the number of bytes to be deleted
    * @param file      the RandomAccessFile object representing the file to be modified
    * @param tempFile  the RandomAccessFile object representing a temporary file used for the deletion
    * @throws IOException  if an I/O error occurs
    */
    public static void deleteData(long start, long count, RandomAccessFile file, RandomAccessFile tempFile) throws IOException {
<span class="fc" id="L83">        FileChannel fileChannel = file.getChannel();</span>
<span class="fc" id="L84">        FileChannel tempChannel = tempFile.getChannel();</span>

<span class="fc" id="L86">        long transferCount = fileChannel.size() - (start + count);</span>

<span class="fc" id="L88">        tempChannel.position(0);</span>
<span class="fc" id="L89">        fileChannel.transferTo(start + count, transferCount, tempChannel);</span>
<span class="fc" id="L90">        file.seek(start);</span>
<span class="fc" id="L91">        tempChannel.position(0);</span>
<span class="fc" id="L92">        fileChannel.transferFrom(tempChannel, start, transferCount);</span>
<span class="fc" id="L93">        fileChannel.truncate(start + transferCount);</span>
<span class="fc" id="L94">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>