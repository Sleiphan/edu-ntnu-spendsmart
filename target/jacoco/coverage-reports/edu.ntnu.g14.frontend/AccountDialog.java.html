<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AccountDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">demo</a> &gt; <a href="index.source.html" class="el_package">edu.ntnu.g14.frontend</a> &gt; <span class="el_source">AccountDialog.java</span></div><h1>AccountDialog.java</h1><pre class="source lang-java linenums">package edu.ntnu.g14.frontend;

import edu.ntnu.g14.Account;
import edu.ntnu.g14.AccountCategory;
import edu.ntnu.g14.BankApplication;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.control.*;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.Pane;
import javafx.scene.layout.Priority;
import javafx.scene.layout.VBox;

import java.math.BigDecimal;
import java.util.regex.Pattern;

public class AccountDialog extends Dialog&lt;Account.AccountBuilder&gt; {
    private final Account.AccountBuilder accountBuilder;
    private ComboBox&lt;String&gt; accountTypeField;
    private TextField amountField;
    private TextField accountNumberField;
    private TextField accountNameField;

    public AccountDialog(Account.AccountBuilder accountBuilder) {
<span class="nc" id="L25">        super();</span>
<span class="nc" id="L26">        this.setTitle(&quot;Add Account&quot;);</span>
<span class="nc" id="L27">        this.accountBuilder = accountBuilder;</span>
<span class="nc" id="L28">        buildUI();</span>
<span class="nc" id="L29">        setResultConverter();</span>
<span class="nc" id="L30">    }</span>

    private void setBuilderFieldValues() {
<span class="nc" id="L33">        accountBuilder.amount(new BigDecimal(amountField.getText()));</span>
<span class="nc" id="L34">        accountBuilder.accountNumber(accountNumberField.getText());</span>
<span class="nc" id="L35">        accountBuilder.accountName(accountNameField.getText());</span>
<span class="nc" id="L36">        accountBuilder.accountCategory(AccountCategory.valueOf(accountTypeField.getValue().replaceAll(&quot; &quot;, &quot;_&quot;).toUpperCase()));</span>
<span class="nc" id="L37">    }</span>

    private void setResultConverter() {
<span class="nc" id="L40">        javafx.util.Callback&lt;ButtonType, Account.AccountBuilder&gt; accountResultConverter = param -&gt; {</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">            if (param == ButtonType.APPLY) {</span>
<span class="nc" id="L42">                setBuilderFieldValues();</span>
<span class="nc" id="L43">                return accountBuilder;</span>
            } else {
<span class="nc" id="L45">                return null;</span>
            }
        };
<span class="nc" id="L48">        setResultConverter(accountResultConverter);</span>
<span class="nc" id="L49">    }</span>

    private void buildUI() {
<span class="nc" id="L52">        Pane pane = createGridPane();</span>
<span class="nc" id="L53">        getDialogPane().setContent(pane);</span>
<span class="nc" id="L54">        getDialogPane().getButtonTypes().addAll(ButtonType.APPLY, ButtonType.CANCEL);</span>
<span class="nc" id="L55">        Button applyButton = (Button) getDialogPane().lookupButton(ButtonType.APPLY);</span>
<span class="nc" id="L56">        applyButton.addEventFilter(ActionEvent.ACTION, new EventHandler&lt;&gt;() {</span>
            @Override
            public void handle(ActionEvent event) {
<span class="nc bnc" id="L59" title="All 2 branches missed.">                if (!validateDialog()) {</span>
<span class="nc" id="L60">                    event.consume();</span>

                }
<span class="nc" id="L63">            }</span>
        });
<span class="nc" id="L65">    }</span>
    private boolean validateDialog() {
<span class="nc" id="L67">        String regexAccountNumber = &quot;[0-9]{4}+\\.[0-9]{2}+\\.[0-9]{5}&quot;;</span>
        BigDecimal amountBigDecimal;
        try {
<span class="nc" id="L70">            amountBigDecimal = new BigDecimal(amountField.getText());</span>
<span class="nc" id="L71">        } catch (NumberFormatException | NullPointerException e) {</span>
<span class="nc" id="L72">            return false;</span>
<span class="nc" id="L73">        }</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        return accountNumberField.getText() != null</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">                &amp;&amp; accountNameField.getText() != null</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">                &amp;&amp; !accountNameField.getText().isBlank()</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">                &amp;&amp; accountTypeField.getValue() != null</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">                &amp;&amp; !(amountBigDecimal.floatValue() &lt; 0)</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">                &amp;&amp; Pattern.matches(regexAccountNumber, accountNumberField.getText())</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">                &amp;&amp; !BankApplication.loggedInUser.checkIfAccountNameIsOccupied(accountNameField.getText())</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">                &amp;&amp; !BankApplication.loggedInUser.checkIfAccountNumberIsOccupied(accountNumberField.getText());</span>
    }

    private Pane createGridPane() {
<span class="nc" id="L85">        VBox content             = new VBox(10);</span>
<span class="nc" id="L86">        Label accountTypeLabel   = new Label(&quot;Choose the type of account:&quot;);</span>
<span class="nc" id="L87">        Label accountNumberLabel = new Label(&quot;Enter the account number:&quot;);</span>
<span class="nc" id="L88">        Label amountLabel        = new Label(&quot;Enter the balance of your account:&quot;);</span>
<span class="nc" id="L89">        Label accountNameLabel   = new Label(&quot;Choose a name for your account:&quot;);</span>
<span class="nc" id="L90">        this.accountTypeField    = new ComboBox&lt;&gt;();</span>
<span class="nc" id="L91">        this.accountNumberField  = new TextField();</span>
<span class="nc" id="L92">        this.amountField         = new TextField();</span>
<span class="nc" id="L93">        this.accountNameField    = new TextField();</span>
<span class="nc" id="L94">        this.accountTypeField.setPromptText(&quot;&quot;);</span>
<span class="nc" id="L95">        this.accountTypeField.getItems().addAll(ApplicationObjects.getAccountCategories());</span>
<span class="nc" id="L96">        this.accountTypeField.setPromptText(&quot;Choose an Account Type&quot;);</span>
<span class="nc" id="L97">        this.accountNameField.setPromptText(&quot;Enter Account Name&quot;);</span>
<span class="nc" id="L98">        this.amountField.setPromptText(&quot;Enter Amount&quot;);</span>
<span class="nc" id="L99">        this.accountNumberField.setPromptText(&quot;11-digit Account Number&quot;);</span>

<span class="nc" id="L101">        GridPane grid = new GridPane();</span>

<span class="nc" id="L103">        grid.setHgap(10);</span>
<span class="nc" id="L104">        grid.setVgap(5);</span>
<span class="nc" id="L105">        grid.add(accountTypeLabel,0,0);</span>
<span class="nc" id="L106">        grid.add(accountNumberLabel,0,1);</span>
<span class="nc" id="L107">        grid.add(amountLabel,0,2);</span>
<span class="nc" id="L108">        grid.add(accountNameLabel,0,3);</span>
<span class="nc" id="L109">        grid.add(accountTypeField,1,0);</span>
<span class="nc" id="L110">        GridPane.setHgrow(this.accountTypeField, Priority.ALWAYS);</span>
<span class="nc" id="L111">        grid.add(accountNumberField, 1,1);</span>
<span class="nc" id="L112">        GridPane.setHgrow(this.accountNumberField,Priority.ALWAYS);</span>
<span class="nc" id="L113">        grid.add(amountField,1,2);</span>
<span class="nc" id="L114">        GridPane.setHgrow(this.amountField,Priority.ALWAYS);</span>
<span class="nc" id="L115">        grid.add(accountNameField,1,3);</span>
<span class="nc" id="L116">        GridPane.setHgrow(this.accountNameField,Priority.ALWAYS);</span>
<span class="nc" id="L117">        accountTypeField.setMaxWidth(160);</span>
<span class="nc" id="L118">        content.getChildren().add(grid);</span>
<span class="nc" id="L119">        return content;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>